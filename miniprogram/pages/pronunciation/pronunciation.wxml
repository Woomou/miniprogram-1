<view class="container">
  <view class="header">
    <text class="title">è‹±è¯­è¯»éŸ³æµ‹è¯•</text>
    <text class="subtitle">é€‰æ‹©å•è¯å¹¶å¼€å§‹æµ‹è¯•</text>
  </view>

  <!-- å•è¯é€‰æ‹©åŒºåŸŸ -->
  <view class="word-selector">
    <view class="selector-container">
      <picker 
        bindchange="onWordSelect" 
        value="{{selectedWordIndex}}" 
        range="{{wordList}}" 
        range-key="word"
      >
        <view class="picker-display">
          <text class="picker-text">{{currentWord.word || 'è¯·é€‰æ‹©å•è¯'}}</text>
          <text class="picker-arrow">â–¼</text>
        </view>
      </picker>
      <!-- è°ƒè¯•ä¿¡æ¯ -->
      <view class="debug-info">
        <text>å•è¯åˆ—è¡¨é•¿åº¦: {{wordList.length}}</text>
      </view>
    </view>
  </view>

  <!-- å•è¯è¯¦æƒ…åŒºåŸŸ -->
  <view class="word-detail" wx:if="{{currentWord.word}}">
    <view class="word-info">
      <text class="word-title">{{currentWord.word}}</text>
      <text class="word-phonetic">/{{currentWord.phonetic}}/</text>
      <text class="word-meaning">{{currentWord.meaning}}</text>
      
      <!-- éš¾åº¦ä¿¡æ¯ -->
      <view class="difficulty-info" wx:if="{{difficultyInfo}}">
        <text class="difficulty-title">éš¾åº¦ç­‰çº§ï¼š</text>
        <view class="difficulty-badge difficulty-{{difficultyInfo.level}}">
          <text class="difficulty-text">{{difficultyInfo.level === 'easy' ? 'ç®€å•' : difficultyInfo.level === 'medium' ? 'ä¸­ç­‰' : 'å›°éš¾'}}</text>
        </view>
      </view>

      <!-- éŸ³ç´ åˆ†æ -->
      <view class="phoneme-analysis" wx:if="{{phonemeInfo.length > 0}}">
        <text class="analysis-title">éŸ³ç´ åˆ†æï¼š</text>
        <view class="phoneme-list">
          <view class="phoneme-item" wx:for="{{phonemeInfo}}" wx:key="index">
            <text class="phoneme-text">{{item.phoneme}}</text>
            <text class="phoneme-type">{{item.type}}</text>
          </view>
        </view>
      </view>

      <!-- å‘éŸ³å»ºè®® -->
      <view class="pronunciation-tips" wx:if="{{pronunciationTips.length > 0}}">
        <text class="tips-title">å‘éŸ³å»ºè®®ï¼š</text>
        <view class="tips-list">
          <text class="tip-item" wx:for="{{pronunciationTips}}" wx:key="index">â€¢ {{item}}</text>
        </view>
      </view>
    </view>

    <!-- å½•éŸ³æµ‹è¯•åŒºåŸŸ -->
    <view class="recording-section">
      <view class="microphone-container">
        <view 
          class="microphone-btn {{isRecording ? 'recording' : ''}}" 
          bindtap="toggleRecording"
        >
          <view class="mic-icon">
            <text class="icon-text">{{isRecording ? 'â¹' : 'ğŸ¤'}}</text>
          </view>
          <text class="mic-text">{{isRecording ? 'å½•éŸ³ä¸­...' : 'ç‚¹å‡»å¼€å§‹å½•éŸ³'}}</text>
        </view>
      </view>

      <!-- å½•éŸ³ç»“æœ -->
      <view class="result-section" wx:if="{{recognitionResult}}">
        <view class="result-title">è¯†åˆ«ç»“æœ</view>
        <view class="comparison">
          <view class="original">
            <text class="label">åŸå•è¯ï¼š</text>
            <text class="text">{{currentWord.word}}</text>
          </view>
          <view class="recognized">
            <text class="label">è¯†åˆ«ç»“æœï¼š</text>
            <text class="text">{{recognitionResult}}</text>
          </view>
        </view>
        
        <view class="accuracy-section">
          <view class="accuracy-bar">
            <view class="accuracy-fill" style="width: {{accuracyScore}}%"></view>
          </view>
          <text class="accuracy-text">å‡†ç¡®åº¦ï¼š{{accuracyScore}}%</text>
        </view>

        <view class="feedback-section" wx:if="{{feedback}}">
          <text class="feedback-title">å‘éŸ³å»ºè®®ï¼š</text>
          <text class="feedback-text">{{feedback}}</text>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <button class="btn btn-primary" bindtap="retryTest" wx:if="{{recognitionResult}}">é‡æ–°æµ‹è¯•</button>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!currentWord.word}}">
    <text class="empty-text">è¯·ä»ä¸Šæ–¹é€‰æ‹©è¦æµ‹è¯•çš„å•è¯</text>
  </view>
</view> 